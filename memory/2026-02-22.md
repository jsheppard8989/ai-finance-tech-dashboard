# Daily Log — 2026-02-22

## Pipeline Deep Dive Session

Spent a long session fixing the AI finance/investing podcast pipeline. Key work done:

### What Was Fixed Today
- **Podcast naming**: Added `.meta.json` sidecar system; `analyze_transcript.py` reads sidecar first, then filename patterns, then content scan
- **Deduplication**: Added `rss_guid` + `published_date` columns to `podcast_episodes`; GUID-first dedup in fetch/curate/analyze scripts
- **2-day age gate**: `fetch_latest.py` and `curate.py` now only pull episodes ≤2 days old
- **Deep dive key**: Changed from title-string match → `insight_id` integer FK in both `db_manager.py` and `index.html` JS
- **Orphan cleanup**: Removed eps 5, 6 (no files); fixed `is_processed` sync for 12 episodes
- **Newsletter promotion**: Fixed `promote_newsletters_to_insights()` in `auto_pipeline.py` — was never actually running
- **Moonshot client**: `get_ai_client()` in `analyze_transcript.py` now tries Moonshot/Kimi first

### Content Added
- 8 new podcast insights (Carson Block, Boz, Brett Adcock, Mallers, Milton Berg, Sam Altman, Moonshots #231/#232)
- 7 newsletter insights via `promote_newsletters_to_insights()` using Moonshot AI
- 6 new deep dives generated via sub-agent (DB now has 20 total deep dives)

### Still Pending (as of compaction)
- **8 insights still need deep dives**: IDs 29, 37, 38, 39, 40, 41, 42, 43
  - IDs 37-43 are `source_type='newsletter'`
  - ID 29 is `source_type='podcast'`
- `generate_deepdives.py` hangs silently when called — output buffering or DB connection issue
- ALLIN podcast feed in `podcast_feeds.txt` returns 404 — should be removed

### Known Issues
- `analyze_transcript.py` has DB cursor bug: `_GeneratorContextManager has no cursor` — uses `db._get_connection()` directly
- Ticker extraction returns 0 mentions — `process_all_transcripts()` isn't calling `add_ticker_mention()` properly

### Architecture Reminders
- **DB**: `~/.openclaw/workspace/pipeline/dashboard.db`
- **Moonshot auth**: `~/.openclaw/agents/main/agent/auth-profiles.json` → `profiles.moonshot:default.key`
- **Moonshot base_url**: `https://api.moonshot.ai/v1`, model `moonshot-v1-8k`
- **Deep dive fields**: `overview`, `key_takeaways_detailed`, `investment_thesis`, `ticker_analysis`, `positioning_guidance`, `risk_factors`, `contrarian_signals`, `catalysts`
- **Data flow**: Database → `export_data.py` → `site/data/data.js` → GitHub Pages

### Cron Schedule (OpenClaw, not system crontab)
- 7:00am CST: Morning Analysis & Publish (Moonshot)
- 12:00pm CST: Midday Price Refresh (cheap, no AI)
- 10:00pm CST: Evening Full Pipeline (`auto_pipeline.py`)

### Dry-Run Test Results (14:53 CST)
All 6 pipeline scripts compile; DB connected; 6/7 RSS feeds OK (ALLIN feed 404); export generated 39 items + 29 deep dives; imports clean; git working tree clean.
